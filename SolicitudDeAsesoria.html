<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Solicitud de Asesoría | Audiograma Decoherence</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        :root {
            --bg-black: #0a0a0a; --bg-card: #111111; --bg-input: #1a1a1a;
            --border: #2a2a2a; --border-hover: #3a3a3a; --text-primary: #ffffff;
            --text-secondary: #888888; --accent: #c0a062; --accent-hover: #d4b46a;
            --accent-glow: rgba(192, 160, 98, 0.15); --error: #cf6679;
        }
        body { font-family: 'Inter', sans-serif; background: var(--bg-black); color: var(--text-primary); min-height: 100vh; line-height: 1.6; overflow-x: hidden; }
        .bg-animation { position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: -1; overflow: hidden; }
        .bg-animation::before { content: ''; position: absolute; top: -50%; left: -50%; width: 200%; height: 200%; background: radial-gradient(circle at 20% 80%, rgba(192, 160, 98, 0.03) 0%, transparent 50%), radial-gradient(circle at 80% 20%, rgba(192, 160, 98, 0.05) 0%, transparent 50%); animation: rotate 40s linear infinite; }
        @keyframes rotate { from { transform: rotate(0deg); } to { transform: rotate(360deg); } }
        .grid-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: -1; background-image: linear-gradient(rgba(255,255,255,0.015) 1px, transparent 1px), linear-gradient(90deg, rgba(255,255,255,0.015) 1px, transparent 1px); background-size: 60px 60px; pointer-events: none; }
        .header { text-align: center; padding: 1.5rem 1.5rem 1rem; position: sticky; top: 0; background: rgba(10, 10, 10, 0.95); backdrop-filter: blur(10px); z-index: 100; border-bottom: 1px solid var(--border); }
        .logo { font-family: 'Inter', sans-serif; font-size: 1.5rem; color: var(--text-primary); margin-bottom: 0.25rem; font-weight: 300; letter-spacing: 3px; text-transform: uppercase; }
        .logo span { color: var(--accent); font-weight: 500; }
        .tagline { color: var(--text-secondary); font-size: 0.75rem; text-transform: uppercase; letter-spacing: 2px; font-weight: 400; }
        .progress-container { max-width: 600px; margin: 0 auto; padding: 1.5rem 1.5rem 1rem; background: var(--bg-black); }
        .progress-bar { display: flex; justify-content: space-between; align-items: center; position: relative; margin-bottom: 0.75rem; }
        .progress-line { position: absolute; top: 50%; left: 0; right: 0; height: 1px; background: var(--border); z-index: 0; transform: translateY(-50%); }
        .progress-fill { position: absolute; top: 50%; left: 0; height: 1px; background: var(--accent); z-index: 1; transform: translateY(-50%); transition: width 0.5s ease; }
        .progress-step { width: 28px; height: 28px; border-radius: 50%; background: var(--bg-card); border: 1px solid var(--border); display: flex; align-items: center; justify-content: center; font-weight: 500; font-size: 0.7rem; color: var(--text-secondary); position: relative; z-index: 2; transition: all 0.3s ease; }
        .progress-step.active { border-color: var(--accent); color: var(--accent); box-shadow: 0 0 15px var(--accent-glow); }
        .progress-step.completed { background: var(--accent); border-color: var(--accent); color: var(--bg-black); }
        .progress-text { text-align: center; color: var(--text-secondary); font-size: 0.75rem; text-transform: uppercase; letter-spacing: 1px; }
        .progress-text span { color: var(--accent); font-weight: 600; }
        .container { max-width: 680px; margin: 0 auto; padding: 0 1.5rem 3rem; }
        .question-card { background: var(--bg-card); border: 1px solid var(--border); border-radius: 12px; padding: 2rem; animation: fadeIn 0.4s ease-out; position: relative; margin-bottom: 1rem; }
        .question-card::before { content: ''; position: absolute; top: 0; left: 0; right: 0; height: 1px; background: linear-gradient(90deg, transparent, var(--accent), transparent); opacity: 0.5; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        .question-number { display: inline-flex; align-items: center; justify-content: center; width: 36px; height: 36px; background: transparent; border: 1px solid var(--accent); color: var(--accent); border-radius: 6px; font-size: 1rem; font-weight: 600; margin-bottom: 1.25rem; }
        .question-label { font-size: 1.25rem; color: var(--text-primary); display: block; margin-bottom: 0.5rem; line-height: 1.3; font-weight: 500; }
        .question-hint { color: var(--text-secondary); font-size: 0.9rem; margin-bottom: 1.5rem; font-weight: 400; }
        .input-wrapper { margin-bottom: 1.5rem; }
        input[type="text"], input[type="tel"], textarea { width: 100%; padding: 1rem; background: var(--bg-input); border: 1px solid var(--border); border-radius: 6px; font-size: 1rem; font-family: 'Inter', sans-serif; color: var(--text-primary); transition: all 0.3s ease; }
        input:focus, textarea:focus { outline: none; border-color: var(--accent); box-shadow: 0 0 0 2px var(--accent-glow); }
        input::placeholder, textarea::placeholder { color: var(--text-secondary); opacity: 0.6; }
        textarea { min-height: 120px; resize: vertical; line-height: 1.6; }
        .options-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(180px, 1fr)); gap: 0.75rem; margin-bottom: 1.5rem; }
        .option-item { position: relative; }
        .option-item input { position: absolute; opacity: 0; cursor: pointer; }
        .option-label { display: block; padding: 0.875rem 1rem; background: var(--bg-input); border: 1px solid var(--border); border-radius: 6px; cursor: pointer; transition: all 0.25s ease; font-size: 0.875rem; text-align: center; color: var(--text-secondary); font-weight: 400; }
        .option-item input:checked + .option-label { background: rgba(192, 160, 98, 0.08); border-color: var(--accent); color: var(--accent); }
        .option-label:hover { border-color: var(--border-hover); }
        .range-container { background: var(--bg-input); padding: 1.25rem; border-radius: 6px; border: 1px solid var(--border); margin-bottom: 1.5rem; }
        input[type="range"] { width: 100%; height: 4px; border-radius: 2px; background: var(--border); outline: none; -webkit-appearance: none; }
        input[type="range"]::-webkit-slider-thumb { -webkit-appearance: none; appearance: none; width: 18px; height: 18px; border-radius: 50%; background: var(--accent); cursor: pointer; box-shadow: 0 0 10px var(--accent-glow); transition: transform 0.2s; }
        input[type="range"]::-webkit-slider-thumb:hover { transform: scale(1.1); }
        .range-value { text-align: center; font-weight: 600; color: var(--accent); margin-top: 0.875rem; font-size: 1.25rem; }
        .range-labels { display: flex; justify-content: space-between; font-size: 0.75rem; color: var(--text-secondary); margin-top: 0.5rem; text-transform: uppercase; letter-spacing: 1px; }
        .conditional-field { background: var(--bg-input); border: 1px solid var(--border); border-left: 2px solid var(--accent); border-radius: 6px; padding: 1rem; margin-bottom: 1.5rem; display: none; animation: slideDown 0.3s ease-out; }
        .conditional-field.active { display: block; }
        .conditional-field.audio-mode { border-left-color: var(--text-secondary); }
        @keyframes slideDown { from { opacity: 0; transform: translateY(-10px); } to { opacity: 1; transform: translateY(0); } }
        .conditional-field label { color: var(--accent); font-weight: 500; display: block; margin-bottom: 0.5rem; font-size: 0.8rem; text-transform: uppercase; letter-spacing: 1px; }
        .conditional-field.audio-mode label { color: var(--text-secondary); }
        .conditional-field p { color: var(--text-secondary); font-size: 0.875rem; line-height: 1.5; }
        .nav-buttons { display: flex; gap: 0.75rem; justify-content: space-between; margin-top: 0.5rem; }
        .btn { padding: 0.875rem 1.5rem; border: none; border-radius: 6px; font-size: 0.875rem; font-weight: 500; cursor: pointer; transition: all 0.3s ease; display: inline-flex; align-items: center; gap: 0.5rem; text-transform: uppercase; letter-spacing: 0.5px; text-decoration: none; }
        .btn-primary { background: var(--accent); color: var(--bg-black); flex: 1; justify-content: center; }
        .btn-primary:hover { background: var(--accent-hover); box-shadow: 0 5px 20px var(--accent-glow); }
        .btn-secondary { background: transparent; color: var(--text-secondary); border: 1px solid var(--border); }
        .btn-secondary:hover { border-color: var(--text-primary); color: var(--text-primary); }
        .btn-whatsapp { background: #25d366; color: #ffffff; width: 100%; justify-content: center; padding: 1rem; font-weight: 600; }
        .btn-whatsapp:hover { background: #128c7e; box-shadow: 0 5px 20px rgba(37, 211, 102, 0.2); }
        .whatsapp-icon { width: 18px; height: 18px; fill: currentColor; }
        .error-msg { display: none; background: rgba(207, 102, 121, 0.1); color: var(--error); padding: 0.75rem 1rem; border-radius: 4px; margin-bottom: 1.25rem; border-left: 2px solid var(--error); font-size: 0.875rem; animation: shake 0.4s ease-out; }
        @keyframes shake { 0%, 100% { transform: translateX(0); } 25% { transform: translateX(-8px); } 75% { transform: translateX(8px); } }
        .hidden { display: none !important; }
        @media (max-width: 640px) { .header { padding: 1.25rem 1rem 0.875rem; } .logo { font-size: 1.25rem; letter-spacing: 2px; } .progress-container { padding: 1.25rem 1rem 0.875rem; } .progress-step { width: 24px; height: 24px; font-size: 0.65rem; } .container { padding: 0 1rem 2rem; } .question-card { padding: 1.5rem; } .question-label { font-size: 1.1rem; } .options-grid { grid-template-columns: 1fr; } .nav-buttons { flex-direction: column; } .btn-secondary { order: 2; } }
    </style>
</head>
<body>
    <div class="bg-animation"></div>
    <div class="grid-overlay"></div>

    <header class="header">
        <div class="logo">Audiograma <span>Decoherence</span></div>
        <div class="tagline">Asesoría Especializada</div>
    </header>

    <div class="progress-container">
        <div class="progress-bar">
            <div class="progress-line"></div>
            <div class="progress-fill" id="progressFill" style="width: 0%"></div>
            <div class="progress-step active" id="step1">1</div>
            <div class="progress-step" id="step2">2</div>
            <div class="progress-step" id="step3">3</div>
            <div class="progress-step" id="step4">4</div>
            <div class="progress-step" id="step5">5</div>
            <div class="progress-step" id="step6">6</div>
            <div class="progress-step" id="step7">7</div>
            <div class="progress-step" id="step8">8</div>
            <div class="progress-step" id="step9">9</div>
            <div class="progress-step" id="step10">10</div>
            <div class="progress-step" id="step11">11</div>
            <div class="progress-step" id="step12">12</div>
        </div>
        <div class="progress-text">Pregunta <span id="currentQuestion">1</span> de 12</div>
    </div>

    <main class="container">
        <form id="asesoriaForm">
            
            <!-- PREGUNTA 1: Nombre -->
            <div class="question-card" id="q1">
                <div class="question-number">01</div>
                <label class="question-label">¿Cuál es tu nombre completo?</label>
                <p class="question-hint">Nos ayudará a personalizar tu asesoría</p>
                <div class="error-msg" id="error1">Por favor ingresa tu nombre</div>
                <div class="input-wrapper">
                    <input type="text" name="nombre" id="nombre" placeholder="Ej: María Fernanda González">
                </div>
                <div class="nav-buttons">
                    <div></div>
                    <button type="button" class="btn btn-primary" onclick="nextQuestion(1)">Siguiente</button>
                </div>
            </div>

            <!-- PREGUNTA 2: Código de miembro (NUEVA) -->
            <div class="question-card hidden" id="q2">
                <div class="question-number">02</div>
                <label class="question-label">¿Cuál es tu código de miembro?</label>
                <p class="question-hint">Ingresa el código que te proporcionaron al registrarte</p>
                <div class="error-msg" id="error2">Por favor ingresa tu código de miembro</div>
                <div class="input-wrapper">
                    <input type="text" name="codigoMiembro" id="codigoMiembro" placeholder="Ej: ADC-2024-001">
                </div>
                <div class="nav-buttons">
                    <button type="button" class="btn btn-secondary" onclick="prevQuestion(2)">Anterior</button>
                    <button type="button" class="btn btn-primary" onclick="nextQuestion(2)">Siguiente</button>
                </div>
            </div>

            <!-- PREGUNTA 3: WhatsApp (antes era 2) -->
            <div class="question-card hidden" id="q3">
                <div class="question-number">03</div>
                <label class="question-label">¿Cuál es tu número de WhatsApp?</label>
                <p class="question-hint">Te contactaremos por ahí para tu asesoría</p>
                <div class="error-msg" id="error3">Por favor ingresa un número válido</div>
                <div class="input-wrapper">
                    <input type="tel" name="whatsapp" id="whatsapp" placeholder="Ej: 5512345678" pattern="[0-9]{10,12}">
                </div>
                <div class="nav-buttons">
                    <button type="button" class="btn btn-secondary" onclick="prevQuestion(3)">Anterior</button>
                    <button type="button" class="btn btn-primary" onclick="nextQuestion(3)">Siguiente</button>
                </div>
            </div>

            <!-- PREGUNTA 4: Área (antes era 3) -->
            <div class="question-card hidden" id="q4">
                <div class="question-number">04</div>
                <label class="question-label">¿En qué área necesitas asesoría?</label>
                <p class="question-hint">Selecciona tu categoría principal de interés</p>
                <div class="error-msg" id="error4">Selecciona una opción</div>
                <div class="options-grid">
                    <div class="option-item">
                        <input type="radio" name="area" id="salud" value="Salud Integral">
                        <label for="salud" class="option-label">Salud Integral</label>
                    </div>
                    <div class="option-item">
                        <input type="radio" name="area" id="belleza" value="Belleza y Cuidado Personal">
                        <label for="belleza" class="option-label">Belleza y Cuidado</label>
                    </div>
                    <div class="option-item">
                        <input type="radio" name="area" id="bienestar" value="Bienestar Mental y Emocional">
                        <label for="bienestar" class="option-label">Bienestar Mental</label>
                    </div>
                    <div class="option-item">
                        <input type="radio" name="area" id="fitness" value="Fitness y Nutrición">
                        <label for="fitness" class="option-label">Fitness y Nutrición</label>
                    </div>
                </div>
                <div class="nav-buttons">
                    <button type="button" class="btn btn-secondary" onclick="prevQuestion(4)">Anterior</button>
                    <button type="button" class="btn btn-primary" onclick="nextQuestion(4)">Siguiente</button>
                </div>
            </div>

            <!-- PREGUNTA 5: Objetivos (antes era 4) -->
            <div class="question-card hidden" id="q5">
                <div class="question-number">05</div>
                <label class="question-label">¿Cuáles son tus objetivos principales?</label>
                <p class="question-hint">Selecciona todos los que apliquen a tu situación</p>
                <div class="error-msg" id="error5">Selecciona al menos un objetivo</div>
                <div class="options-grid">
                    <div class="option-item">
                        <input type="checkbox" name="objetivos" id="obj1" value="Pérdida de peso saludable">
                        <label for="obj1" class="option-label">Pérdida de peso</label>
                    </div>
                    <div class="option-item">
                        <input type="checkbox" name="objetivos" id="obj2" value="Ganancia muscular o tonificación">
                        <label for="obj2" class="option-label">Ganancia muscular</label>
                    </div>
                    <div class="option-item">
                        <input type="checkbox" name="objetivos" id="obj3" value="Mejorar piel, cabello o uñas">
                        <label for="obj3" class="option-label">Belleza natural</label>
                    </div>
                    <div class="option-item">
                        <input type="checkbox" name="objetivos" id="obj4" value="Reducir estrés y ansiedad">
                        <label for="obj4" class="option-label">Manejo del estrés</label>
                    </div>
                    <div class="option-item">
                        <input type="checkbox" name="objetivos" id="obj5" value="Mejorar calidad del sueño">
                        <label for="obj5" class="option-label">Descanso reparador</label>
                    </div>
                    <div class="option-item">
                        <input type="checkbox" name="objetivos" id="obj6" value="Alimentación consciente">
                        <label for="obj6" class="option-label">Hábitos alimenticios</label>
                    </div>
                    <div class="option-item">
                        <input type="checkbox" name="objetivos" id="obj7" value="Aumentar energía y vitalidad">
                        <label for="obj7" class="option-label">Más energía</label>
                    </div>
                    <div class="option-item">
                        <input type="checkbox" name="objetivos" id="obj8" value="Equilibrio hormonal">
                        <label for="obj8" class="option-label">Salud hormonal</label>
                    </div>
                </div>
                <div class="nav-buttons">
                    <button type="button" class="btn btn-secondary" onclick="prevQuestion(5)">Anterior</button>
                    <button type="button" class="btn btn-primary" onclick="nextQuestion(5)">Siguiente</button>
                </div>
            </div>

            <!-- PREGUNTA 6: Actividad Física (antes era 5) -->
            <div class="question-card hidden" id="q6">
                <div class="question-number">06</div>
                <label class="question-label">¿Cuál es tu nivel de actividad física?</label>
                <p class="question-hint">Selecciona tu rutina actual de ejercicio</p>
                <div class="error-msg" id="error6">Selecciona una opción</div>
                <div class="options-grid">
                    <div class="option-item">
                        <input type="radio" name="actividad" id="sedentario" value="Sedentario">
                        <label for="sedentario" class="option-label">Sedentario</label>
                    </div>
                    <div class="option-item">
                        <input type="radio" name="actividad" id="ligero" value="Ligero (1-2 días/semana)">
                        <label for="ligero" class="option-label">Ligero</label>
                    </div>
                    <div class="option-item">
                        <input type="radio" name="actividad" id="moderado" value="Moderado (3-4 días/semana)">
                        <label for="moderado" class="option-label">Moderado</label>
                    </div>
                    <div class="option-item">
                        <input type="radio" name="actividad" id="activo" value="Muy Activo (5+ días/semana)">
                        <label for="activo" class="option-label">Muy Activo</label>
                    </div>
                </div>
                <div class="nav-buttons">
                    <button type="button" class="btn btn-secondary" onclick="prevQuestion(6)">Anterior</button>
                    <button type="button" class="btn btn-primary" onclick="nextQuestion(6)">Siguiente</button>
                </div>
            </div>

            <!-- PREGUNTA 7: Restricciones (antes era 6) -->
            <div class="question-card hidden" id="q7">
                <div class="question-number">07</div>
                <label class="question-label">¿Tienes restricciones alimentarias o condiciones de salud?</label>
                <p class="question-hint">Selecciona todas las que apliquen</p>
                <div class="error-msg" id="error7">Selecciona al menos una opción</div>
                <div class="options-grid">
                    <div class="option-item">
                        <input type="checkbox" name="restricciones" id="rest1" value="Ninguna">
                        <label for="rest1" class="option-label">Ninguna</label>
                    </div>
                    <div class="option-item">
                        <input type="checkbox" name="restricciones" id="rest2" value="Vegetariano/Vegano">
                        <label for="rest2" class="option-label">Vegetariano/Vegano</label>
                    </div>
                    <div class="option-item">
                        <input type="checkbox" name="restricciones" id="rest3" value="Sin gluten">
                        <label for="rest3" class="option-label">Sin gluten</label>
                    </div>
                    <div class="option-item">
                        <input type="checkbox" name="restricciones" id="rest4" value="Sin lactosa">
                        <label for="rest4" class="option-label">Sin lactosa</label>
                    </div>
                    <div class="option-item">
                        <input type="checkbox" name="restricciones" id="rest5" value="Diabetes">
                        <label for="rest5" class="option-label">Diabetes</label>
                    </div>
                    <div class="option-item">
                        <input type="checkbox" name="restricciones" id="rest6" value="Hipertensión">
                        <label for="rest6" class="option-label">Hipertensión</label>
                    </div>
                    <div class="option-item">
                        <input type="checkbox" name="restricciones" id="rest7" value="Alergias">
                        <label for="rest7" class="option-label">Alergias</label>
                    </div>
                    <div class="option-item">
                        <input type="checkbox" name="restricciones" id="rest8" value="Embarazo/Lactancia">
                        <label for="rest8" class="option-label">Embarazo/Lactancia</label>
                    </div>
                </div>
                <div class="input-wrapper">
                    <textarea name="condicionesDetalle" placeholder="Especifica otras condiciones o detalles importantes..."></textarea>
                </div>
                <div class="nav-buttons">
                    <button type="button" class="btn btn-secondary" onclick="prevQuestion(7)">Anterior</button>
                    <button type="button" class="btn btn-primary" onclick="nextQuestion(7)">Siguiente</button>
                </div>
            </div>

            <!-- PREGUNTA 8: Horas de Sueño (antes era 7) -->
            <div class="question-card hidden" id="q8">
                <div class="question-number">08</div>
                <label class="question-label">¿Cuántas horas duermes por noche?</label>
                <p class="question-hint">Desliza para seleccionar tu promedio</p>
                <div class="range-container">
                    <input type="range" min="4" max="12" value="7" id="horasSueno" name="horasSueno" oninput="updateRangeValue(this.value)">
                    <div class="range-value" id="rangeValue">7 horas</div>
                    <div class="range-labels">
                        <span>4h</span>
                        <span>8h</span>
                        <span>12h</span>
                    </div>
                </div>
                <div class="nav-buttons">
                    <button type="button" class="btn btn-secondary" onclick="prevQuestion(8)">Anterior</button>
                    <button type="button" class="btn btn-primary" onclick="nextQuestion(8)">Siguiente</button>
                </div>
            </div>

            <!-- PREGUNTA 9: Consumo de Agua (antes era 8) -->
            <div class="question-card hidden" id="q9">
                <div class="question-number">09</div>
                <label class="question-label">¿Cuántos litros de agua bebes al día?</label>
                <p class="question-hint">Selecciona tu hábito de hidratación habitual</p>
                <div class="error-msg" id="error9">Selecciona una opción</div>
                <div class="options-grid">
                    <div class="option-item">
                        <input type="radio" name="agua" id="agua1" value="Menos de 1 litro">
                        <label for="agua1" class="option-label">Menos de 1 litro</label>
                    </div>
                    <div class="option-item">
                        <input type="radio" name="agua" id="agua2" value="1-2 litros">
                        <label for="agua2" class="option-label">1-2 litros</label>
                    </div>
                    <div class="option-item">
                        <input type="radio" name="agua" id="agua3" value="2-3 litros">
                        <label for="agua3" class="option-label">2-3 litros</label>
                    </div>
                    <div class="option-item">
                        <input type="radio" name="agua" id="agua4" value="Más de 3 litros">
                        <label for="agua4" class="option-label">Más de 3 litros</label>
                    </div>
                </div>
                <div class="nav-buttons">
                    <button type="button" class="btn btn-secondary" onclick="prevQuestion(9)">Anterior</button>
                    <button type="button" class="btn btn-primary" onclick="nextQuestion(9)">Siguiente</button>
                </div>
            </div>

            <!-- PREGUNTA 10: Rutina Diaria (antes era 9) -->
            <div class="question-card hidden" id="q10">
                <div class="question-number">10</div>
                <label class="question-label">Describe tu rutina diaria típica</label>
                <p class="question-hint">Cuéntanos sobre tu día: horario de trabajo, comidas, ejercicio, etc.</p>
                <div class="error-msg" id="error10">Por favor describe tu rutina</div>
                <div class="input-wrapper">
                    <textarea name="rutina" id="rutina" placeholder="Ej: Me despierto a las 6:30am, desayuno café y pan, trabajo de 9am a 6pm en oficina, como frente al escritorio, llego a casa cansado, ceno cereal y me duermo viendo TV a las 11pm..."></textarea>
                </div>
                <div class="nav-buttons">
                    <button type="button" class="btn btn-secondary" onclick="prevQuestion(10)">Anterior</button>
                    <button type="button" class="btn btn-primary" onclick="nextQuestion(10)">Siguiente</button>
                </div>
            </div>

            <!-- PREGUNTA 11: Intentos Previos (antes era 10) -->
            <div class="question-card hidden" id="q11">
                <div class="question-number">11</div>
                <label class="question-label">¿Qué has intentado antes que NO funcionó?</label>
                <p class="question-hint">Dietas, rutinas, productos fallidos (opcional pero nos ayuda mucho)</p>
                <div class="input-wrapper">
                    <textarea name="intentosPrevios" placeholder="Ej: Hice dieta keto 3 meses y recuperé el doble, probé crossfit pero me lesioné, suplementos caros sin efecto..."></textarea>
                </div>
                <div class="nav-buttons">
                    <button type="button" class="btn btn-secondary" onclick="prevQuestion(11)">Anterior</button>
                    <button type="button" class="btn btn-primary" onclick="nextQuestion(11)">Siguiente</button>
                </div>
            </div>

            <!-- PREGUNTA 12: Tipo de Consulta (antes era 11) -->
            <div class="question-card hidden" id="q12">
                <div class="question-number">12</div>
                <label class="question-label">¿Cómo quieres explicar tu consulta?</label>
                <p class="question-hint">Elige la forma más cómoda para ti de contarnos tu caso</p>
                <div class="error-msg" id="error12">Selecciona una opción</div>
                <div class="options-grid">
                    <div class="option-item">
                        <input type="radio" name="tipoConsulta" id="escribir" value="Escribir" onchange="toggleConsultaType('escribir')">
                        <label for="escribir" class="option-label">Escribir ahora</label>
                    </div>
                    <div class="option-item">
                        <input type="radio" name="tipoConsulta" id="audio" value="Enviar audio después" onchange="toggleConsultaType('audio')">
                        <label for="audio" class="option-label">Enviar audio después</label>
                    </div>
                </div>

                <div class="conditional-field" id="campoEscribir">
                    <label>Escribe tu consulta:</label>
                    <textarea name="consultaEscrita" id="consultaEscrita" placeholder="Describe detalladamente qué necesitas, tus síntomas, preocupaciones o lo que esperas de la asesoría..."></textarea>
                </div>

                <div class="conditional-field audio-mode" id="campoAudio">
                    <label>MODO AUDIO SELECCIONADO</label>
                    <p>Después de enviar esta solicitud, podrás grabar y enviar un audio por WhatsApp explicando tu caso con más detalle.</p>
                    <input type="hidden" name="consultaAudio" id="consultaAudioFlag" value="">
                </div>

                <div class="nav-buttons">
                    <button type="button" class="btn btn-secondary" onclick="prevQuestion(12)">Anterior</button>
                    <!-- BOTÓN WHATSAPP - SIN JAVASCRIPT EN EL ONCLICK, SOLO HREF DINÁMICO -->
                    <a href="#" class="btn btn-whatsapp" id="whatsappBtn" onclick="return handleWhatsAppClick(event)">
                        <svg class="whatsapp-icon" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                            <path d="M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.004 5.45-4.439 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893a11.821 11.821 0 00-3.48-8.413Z"/>
                        </svg>
                        Enviar por WhatsApp
                    </a>
                </div>
            </div>

        </form>
    </main>

    <script>
        let currentStep = 1;
        const totalSteps = 12;
        const telefono = '5535691939';

        function updateProgress() {
            const percentage = ((currentStep - 1) / (totalSteps - 1)) * 100;
            document.getElementById('progressFill').style.width = percentage + '%';
            document.getElementById('currentQuestion').textContent = currentStep;
            
            for (let i = 1; i <= totalSteps; i++) {
                const stepEl = document.getElementById('step' + i);
                if (i < currentStep) {
                    stepEl.classList.add('completed');
                    stepEl.classList.remove('active');
                } else if (i === currentStep) {
                    stepEl.classList.add('active');
                    stepEl.classList.remove('completed');
                } else {
                    stepEl.classList.remove('active', 'completed');
                }
            }
            
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        function validateQuestion(num) {
            let valid = true;
            const errorEl = document.getElementById('error' + num);
            
            switch(num) {
                case 1:
                    const nombre = document.getElementById('nombre').value.trim();
                    if (!nombre) valid = false;
                    break;
                case 2:
                    const codigo = document.getElementById('codigoMiembro').value.trim();
                    if (!codigo) valid = false;
                    break;
                case 3:
                    const whatsapp = document.getElementById('whatsapp').value.trim();
                    if (!whatsapp || whatsapp.length < 10) valid = false;
                    break;
                case 4:
                    if (!document.querySelector('input[name="area"]:checked')) valid = false;
                    break;
                case 5:
                    if (document.querySelectorAll('input[name="objetivos"]:checked').length === 0) valid = false;
                    break;
                case 6:
                    if (!document.querySelector('input[name="actividad"]:checked')) valid = false;
                    break;
                case 7:
                    if (document.querySelectorAll('input[name="restricciones"]:checked').length === 0) valid = false;
                    break;
                case 8:
                    break;
                case 9:
                    if (!document.querySelector('input[name="agua"]:checked')) valid = false;
                    break;
                case 10:
                    const rutina = document.getElementById('rutina').value.trim();
                    if (!rutina) valid = false;
                    break;
                case 11:
                    break;
                case 12:
                    const tipoConsulta = document.querySelector('input[name="tipoConsulta"]:checked');
                    if (!tipoConsulta) {
                        valid = false;
                    } else if (tipoConsulta.value === 'Escribir') {
                        const consulta = document.getElementById('consultaEscrita').value.trim();
                        if (!consulta) valid = false;
                    }
                    break;
            }
            
            if (!valid && errorEl) {
                errorEl.style.display = 'block';
                setTimeout(() => errorEl.style.display = 'none', 3000);
            }
            
            return valid;
        }

        function nextQuestion(current) {
            if (!validateQuestion(current)) return;
            
            document.getElementById('q' + current).classList.add('hidden');
            currentStep = current + 1;
            document.getElementById('q' + currentStep).classList.remove('hidden');
            updateProgress();
        }

        function prevQuestion(current) {
            document.getElementById('q' + current).classList.add('hidden');
            currentStep = current - 1;
            document.getElementById('q' + currentStep).classList.remove('hidden');
            updateProgress();
        }

        function updateRangeValue(value) {
            document.getElementById('rangeValue').textContent = value + ' horas';
        }

        function toggleConsultaType(type) {
            const campoEscribir = document.getElementById('campoEscribir');
            const campoAudio = document.getElementById('campoAudio');
            
            if (type === 'escribir') {
                campoEscribir.classList.add('active');
                campoAudio.classList.remove('active');
            } else {
                campoEscribir.classList.remove('active');
                campoAudio.classList.add('active');
                document.getElementById('consultaAudioFlag').value = 'El usuario enviará audio explicando su caso después';
            }
        }

        function construirMensaje() {
            const formData = new FormData(document.getElementById('asesoriaForm'));
            const objetivos = Array.from(formData.getAll('objetivos')).join(', ');
            const restricciones = Array.from(formData.getAll('restricciones')).join(', ');
            const tipoConsulta = formData.get('tipoConsulta');
            
            let mensaje = `SOLICITUD DE ASESORÍA VÍA AUDIOGRAMA\n`;
            mensaje += `========================================\n\n`;
            
            mensaje += `DATOS DE CONTACTO\n`;
            mensaje += `-----------------\n`;
            mensaje += `Nombre: ${formData.get('nombre')}\n`;
            mensaje += `Código de miembro: ${formData.get('codigoMiembro')}\n`;
            mensaje += `WhatsApp: ${formData.get('whatsapp')}\n\n`;
            
            mensaje += `INFORMACIÓN GENERAL\n`;
            mensaje += `-------------------\n`;
            mensaje += `Área de interés: ${formData.get('area')}\n`;
            mensaje += `Objetivos: ${objetivos}\n`;
            mensaje += `Nivel de actividad: ${formData.get('actividad')}\n\n`;
            
            mensaje += `SALUD Y HÁBITOS\n`;
            mensaje += `---------------\n`;
            mensaje += `Restricciones/Condiciones: ${restricciones}\n`;
            if (formData.get('condicionesDetalle')) {
                mensaje += `Detalles adicionales: ${formData.get('condicionesDetalle')}\n`;
            }
            mensaje += `Horas de sueño: ${formData.get('horasSueno')} horas\n`;
            mensaje += `Consumo de agua: ${formData.get('agua')}\n\n`;
            
            mensaje += `CONTEXTO PERSONAL\n`;
            mensaje += `-----------------\n`;
            mensaje += `Rutina diaria:\n${formData.get('rutina')}\n\n`;
            
            if (formData.get('intentosPrevios')) {
                mensaje += `Intentos previos fallidos:\n${formData.get('intentosPrevios')}\n\n`;
            }
            
            mensaje += `CONSULTA\n`;
            mensaje += `--------\n`;
            if (tipoConsulta === 'Escribir') {
                mensaje += `${formData.get('consultaEscrita')}\n\n`;
            } else {
                mensaje += `[El usuario enviará un audio explicando su caso detalladamente después de esta solicitud]\n\n`;
            }
            
            mensaje += `========================================\n`;
            mensaje += `Enviado desde Audiograma Decoherence`;
            
            return mensaje;
        }

        // FUNCIÓN CLAVE: Todo debe ejecutarse SÍNCRONAMENTE en el click
        function handleWhatsAppClick(event) {
            // Validar primero
            if (!validateQuestion(12)) {
                event.preventDefault();
                return false;
            }

            // Construir mensaje SÍNCRONAMENTE (sin async)
            const mensaje = construirMensaje();
            
            // Crear URL SÍNCRONAMENTE
            const whatsappUrl = `https://wa.me/${telefono}?text=${encodeURIComponent(mensaje)}`;
            
            // Asignar al href del enlace que fue clickeado
            event.currentTarget.href = whatsappUrl;
            
            // Para iOS: también intentar location.href como backup
            if (/iPad|iPhone|iPod/.test(navigator.userAgent)) {
                window.location.href = whatsappUrl;
            }
            
            // Permitir que el enlace siga su curso natural
            return true;
        }

        updateProgress();
    </script>
</body>
</html>